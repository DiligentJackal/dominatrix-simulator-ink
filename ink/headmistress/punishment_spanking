VAR headmistress_spanking_target_count = 10
VAR headmistress_spanking_implement = "hand"
VAR headmistress_spanking_count = 0
VAR headmistress_spanking_break_count = 0
VAR headmistress_spanking_mistakes = 0


=== headmistress_punishment_spanking ===

~ setScene(punishment_scene, Headmistress)
-> start

= start

TODO: Support shuffling swats and equipment

// {shuffle:
// - ~ headmistress_spanking_target_count = 10
// - ~ headmistress_spanking_target_count = 25
// - ~ headmistress_spanking_target_count = 35
// }

// Just use '10' swats for now.
~ headmistress_spanking_target_count = 10

// {shuffle:
// - ~headmistress_spanking_implement = "paddle"
// - ~headmistress_spanking_implement = "hand"
// - ~headmistress_spanking_implement = "crop"
// }

// Just use the hand for now.
~ headmistress_spanking_implement = "hand"

~ headmistress_spanking_break_count = 0
~ headmistress_spanking_count = 0
~ headmistress_spanking_mistakes = 0


/scene LectureHall.Punishment_Spanking
/music headmistress-punishment
/character headmistress
// /equip {headmistress_spanking_implement}
// /perform circle_desk

-> get_on_desk ->

{inTutorial: -> punish_intro | -> punish_continue}

= get_on_desk

{inTutorial: 
    Punishments are administered with the slave perched upon my desk. #05
- else:
    For your transgressions, #01
    a spanking is in order. #02
}

/character headmistress point_paddle_at_desk
Alight forthwith! #08

- (prompt)
/perform idle

+ [move:get_on_desk]
    Pleasingly executed. #09
+ [timeout]
    -- (get_on_desk_timed_out)
    Our guests are waiting.<br/>Tut. Tut. #12
    -> prompt


- (kneel)
/perform point_down
 Now, kneel, slave. #225

~ tries = 0
- (kneel_tries)
~ tries++

+ [pose:kneel]
+ { tries < 2 } [timeout] -> kneel_tries
+ { tries >= 2 } [timeout] -> Headmistress_NoAction -> kneel

-
{tries == 1:
    ~ addObey()
    /perform look_up_and_down
    Observe the eagerness with which our chattel attempts to comply. #13
    This behaviour pleases Her. #14
- else:
    ~ addDisobey()
    /perform displeased
    Note the hesitation. A sure sign of poor breeding. #15
    Such offends the Goddess and must be stricken from the specimen. #16
}

->->

= punish_intro

- /perform one_finger
The muscles of the ass must remain relaxed between swats. #44
/perform open_arms_behold
This provides an exceptionally pleasing display when they clench #45
/perform serious
in response to the impact of my admonishments. #46
//perform tap_paddle


- /character headmistress smooth_skirt
But enough of this pretense. #48

/character crowd murmur
/ambient crowd
/character headmistress idle
We aren't here just for you. #49

/character headmistress serious
We have our entire class to enlighten! #50

- 
Let us show our audience #51
the fine display you have for us. #52
/character crowd cheers_loud
~ Headmistress_RaiseCurtains()

-> punish_continue


= punish_continue

/character headmistress arm_raise happy 

Welcome esteemed guests! #53

/perform idle
Our subject today has earned a spanking. #54

/perform serious
{headmistress_spanking_implement == "paddle":
    I will use a paddle made of mahogany. #55
    /perform open_arms_behold
    An excellent, hard wood ideal for leaving #56
    bright red welts on the flesh of disobedient slaves. #57
}

{headmistress_spanking_implement == "hand":
    My own hand will do today. #58
    /perform open_arms_behold
    I want to relish the crisp strike of my hand #60
    and the quivering sound of flesh meeting flesh. #61
}

{headmistress_spanking_implement == "crop":
    For today's punishment, I have selected #62
    a slender and rigid crop. #63
    /perform open_arms_behold
    The pattern of stinging pain that will burst forth #64
    from the skin is exotic to behold! #65
}

/character crowd oos 

- /character headmistress laugh
Listen to that excitement, {player_name}. #67
Your ass will provide a fine demonstration today. #68

- (fortunate)
/perform open_arms_shrug
Are they not fortunate to have one such as you to observe? #69

+[yes]
    ~ addObey()
    /perform serious
    Perform well and your punishment marker will be removed. #70

+[no]
    ~ addDisobey()
    /perform displeased
    It is a shame you do not value the learning of others. #71
    
+ [timeout] -> Headmistress_Timeout -> fortunate
+ [distracted] -> Headmistress_PayAttention -> fortunate

- /perform open_arms_behold
As always, purrs, moans, and words of encouragement #73
are permitted during the punishment lesson. #74

/character crowd oos
/character headmistress idle

What say you, {isBoy: toad|strumpet}? #79

- (aroused)

{cycle:
    - Will our esteemed guests be enthralled #80
     by {hasPenis:your turgid bouncing cock?|the glistening of your cunt?} #81
    - Do you feel their eyes on you? #82
    - Are you throbbing in anticipation? #83
    - Do you want to touch yourself? #84
    - Does pain turn you on? #85
    - Are you {hasPenis: hard|wet}? #04
}

+ [yes]
    ~ addObey()
    /perform curious
    /character crowd cheers 
    /character headmistress idle
    So eager for your debasement. #86
    Most pleasing. #87

+ [no]
    ~ addDisobey()
    /perform thoughtful
    /character crowd boos
    /character headmistress
    A disappointing response for our guests. #88
    /perform serious
    //Rectify this immediately, slave. #226
    //line no longer fits scene - what to do with it?
    
+ [timeout] -> Headmistress_Timeout -> aroused
+ [distracted] -> Headmistress_PayAttention -> aroused

 - Our guests will relish your punishment so much more if your {hasPenis: rod is rigid|slit is slick}. #03
 
 - (get_aroused)
 
Shall we appease them? #59

+[yes]
   -> Headmistress_AcknowledgeYes ->
   ~headmistress_masturbated_for_crowd = true

+[no]
   -> Headmistress_Unhappy ->
   Sexual excitation makes for a more delightful punishment. #111
   -> Headmistress_Resume -> punishment_ready
 
+ [timeout] -> Headmistress_Timeout -> get_aroused
+ [distracted] -> Headmistress_PayAttention -> get_aroused

- /perform idle
Rub yourself until your {hasPenis: shaft is hard|slit is wet}. #227
 
+ [wait:3]

- -> Headmistress_masturbation_comments ->

+ [wait 3]

- Pray continue. #228

+ [wait:3]

- -> Headmistress_masturbation_comments ->

+ [wait:3]

- -> Headmistress_masturbation_comments ->

+ [wait 3]

- A little more, I think. #229
 
+ [wait:3]

- -> Headmistress_masturbation_comments ->

- (accept_punishment)

+ [continue]

- (please)
/character headmistress
 What say you, slave, will your {hasPenis: rod|folds} please our guests? #230

+ [yes]
    ~ addObey()
    Excellent. Then let us continue. #231
      
+ [no]
    ~ addDisobey()
    A disappointment. We shall continue anyways. #232
 
+ [timeout] -> Headmistress_Timeout -> please
+ [distracted] -> Headmistress_PayAttention -> please

- /perform smooth_skirt

And finally, we come to the heart of the matter. #91

- (punishment_ready)

/emotion skeptical 50
Do you accept that you must be punished? #92

- (ask_punish_ready)

+ [yes]
    ~ addObey()
    /perform arm_raise
    Your acceptance is most becoming. #93
    /character crowd cheers
    /character headmistress idle

+ [no]
    ~ addDisobey()
    /character crowd boos
    /character headmistress suspicious
    Foolish, little slave. #94
    
    It will be over quickly and your compliance will please the Goddess. #95
    /perform inspect
    -- (continue)
    Shall we continue with your punishment? #96

    ++ [yes]
        ~ addObey()
        /perform serious
        Magnificent. Let us begin. #97
        
    ++ [no]
        ~ addDisobey()
        /character crowd angry_crowd
        /character headmistress unhappy
        Make haste from my sight! #98
        You have squandered my time and my attentions. #99
        I will not suffer fools. #100

        {not inTutorial:
            You've just earned yet another punishment. #101
            ~ addPunishment()
            ~ headmistress_apologize = true
        }

        Now leave. #102
        /perform point_to_leave
        -> exit
        
    ++ [timeout] -> Headmistress_Timeout -> continue
    ++ [distracted] -> Headmistress_PayAttention -> continue

+ [timeout] 
    -- (accept_timeout)
    /perform pleased
    You have had enough time to think. #103
    Your punishment must begin. #104
    Do you agree? #105
    -> ask_punish_ready

+ [distracted] -> Headmistress_PayAttention -> accept_timeout

- {inTutorial: -> headmistress_train_spanking(false) -> spank_continue }

- /perform serious
Because I am generous, #234
I will offer you a chance to practice first. #106

- (practice)
/perform idle_tease
Would you welcome that, {isBoy: mongrel|moppet}? #107
~ headmistress_difficulty = 1

+[yes]
    -> headmistress_train_spanking(false) ->

+[no]
    /perform nod
    An expert, are we? We will see about that. #108

+ [timeout] -> Headmistress_Timeout -> practice
+ [distracted] -> Headmistress_PayAttention -> practice

- (spank_continue)

/perform curious
Back onto your hands and knees, slave. #244

+ [pose:hands_and_knees]
+ [timeout] -> Headmistress_NoAction -> spank_continue

- /perform idle
Let us begin in earnest! #245
/character crowd cheers_loud

+ [wait]

- /scene LectureHall.HeadmistressAtBack

// /character headmistress walk_to_back_of_desk

/character crowd murmur

/character headmistress idle skeptical 40

// 10, 25, 35
Prepare yourself for ten swats, {player_name}. #127

- (spank)
/character headmistress paddle_ass

+ [react-success]
    ~ headmistress_spanking_count++
    ~ headmistress_spanking_break_count++
    
    {headmistress_spanking_break_count %2 == 0: 
    -> Headmistress_GoodSpank ->
    }
    
    {headmistress_spanking_break_count >= 6:
    
        // Check mistakes for obey or disobey adjustment
        {headmistress_spanking_mistakes > 0:
            ~ addDisobey()
        - else:
            ~ addObey()
        }
        
        // Reset the mistake counter.
        ~headmistress_spanking_mistakes = 0
        
        -> SpankBreak ->
    }
    {headmistress_spanking_count < headmistress_spanking_target_count: -> spank}
+ [react-fail] -> Headmistress_BadSpank -> spank

- -> SpankingFinished

= SpankingFinished
/scene LectureHall.HeadmistressAtFront
/character headmistress satisfied

- (feel_better)
Ahhhh. Now, don't you feel better, {player_name}? #128

+[yes]
    /perform pleased
    ~ addObey()
    That is because you desire #129
    to be an obedient little toy. #130
    
+[no]
    /perform idle_tease
    ~ addDisobey()
    Too bad. You should have thought of that sooner. #258
    
+ [timeout] -> Headmistress_Timeout -> feel_better
+ [distracted] -> Headmistress_PayAttention -> feel_better

- /perform open_arms_behold
Your ass has blossomed into an objet d'art. #133
/perform nod    
Consider one demerit paid in full. #145
~ removePunishment()
~ has_learned_spanking = true
/character crowd cheers_loud
/character headmistress

- {obeyed():
    -> GoodEnding
- else:
    -> BadEnding
}


= GoodEnding

/perform arm_raise
You comported yourself quite well. #131
What a crowd pleaser! #136
You should be proud of your performance. #132
/character crowd cheers
/character headmistress
-> FinalEnding


= BadEnding

/perform sassy
You may have finished enduring your punishment, #140
but your overall performance was quite unsatisfactory. #141
You have a long ways to go. #249
-> FinalEnding


= FinalEnding

/character headmistress idle

~ tries = 0
- (stand_straight)
~ tries++

/perform one_finger
Stand at attention! #257

+ [pose:raised_chin]
+ { tries < 2 } [timeout] -> stand_straight
+ { tries >= 2 } [timeout] -> Headmistress_NoAction -> stand_straight


- (leave)
/perform point_down
{obeyed(): 
        You may descend and return to Mistress Yuki-Onna with my compliments. #139
    - else: 
        I give you leave to depart. #146
}

- 
+ [move]
+ [timeout] -> Headmistress_NoAction -> leave

// If in the tutorial, send player off to be tempted by her directly.
- {inTutorial: 
    ~ tutorial_hm_intro_complete = true
    -> nega_intro
- else:
    -> exit
}




// Tunnels


= SpankBreak

~ headmistress_spanking_break_count = 0

- /scene LectureHall.HeadmistressAtFront

- {cycle: 
    - You may rest back on your heels, slave. #251
    - Sit upright for your fans, slave. #252
    - Raise yourself up and sit upon your heels, slave. #253
    }

~ tries = 0
- (kneel_break)
~ tries++

+ [pose:kneel]
+ { tries < 2 } [timeout] -> kneel_break
+ { tries >= 2 } [timeout] -> Headmistress_NoAction -> SpankBreak

- 
{inTutorial:
    { cycle:
        // - -> break01 -> 
        // - -> break02 ->
        - -> break03 ->
        //- -> break04 ->
    }
- else:
    { shuffle:
        - -> break01 -> 
        - -> break02 ->
        - -> break03 ->
        //- -> break04 ->
    }
}


+ [continue]

- {cycle:
    - Back on your hands and knees, slave. #254
    - Resume your spanking position, slave. #255
    - Present your ass, {isBoy: runt|strumpet}. #256
}

+ [pose:hands_and_knees]
+ [timeout] -> Headmistress_NoAction -> SpankBreak

- /scene LectureHall.HeadmistressAtBack
->->


= break01

/perform thoughtful
Have you been keeping count {isBoy: toad|strumpet}? #10

+[yes]
 ~ addObey()
    /perform nod
    Let's see how well. #18
    Are we up to seven now? #21
    
        ++[yes]
        Tsk. Tsk. #22
        We are only at six.  #23
        Time to start over! #24
        I suggest you remember to count this time, foible. #26
        ~ headmistress_spanking_count = 0
        -> spank
        
        ++[no]
        Paying attention, are we? #27
        I hope you know we are only at six. #28
        -> Headmistress_punishment_resumes ->
        ->->
        
+[no]
 ~ addDisobey()
    Do you hear that, my students? #31
    This one has no breeding or experience. #32
    It fails to count. #33
    We shall start over! #34
    This flaw I shall address in the future. #35
     ~ headmistress_spanking_count = 0
    -> Headmistress_punishment_resumes ->
    -> spank 

+ [timeout] -> Headmistress_Timeout -> break01
+ [distracted] -> Headmistress_PayAttention -> break01

= break02

/perform serious
Every now and then, the object of correction #175
must be given a moment to compose themself. #176
/character crowd murmur

/character headmistress one_finger
However, this time should not be squandered with mere rest. #177

/perform idle
Reach down and stroke your {hasPenis: shaft|folds}. #178
/character crowd gasps
/character headmistress
Punishments must be associated with sensual excitation. #179

Does it feel good to touch yourself, {isBoy: toad|strumpet}? #180
//need moans or some other sexual sound during this scene
+[yes]
    ~ addObey()
    /perform nod
    As it should. #181
    You may continue until I instruct you otherwise. #182

+[no]
    ~ addDisobey()
    What a shame. Do it anyways. #183

+ [timeout] -> Headmistress_Timeout -> break02
+ [distracted] -> Headmistress_PayAttention -> break02

- /character headmistress idle
+[wait:5]
- -> Headmistress_masturbation_comments ->

+[wait:5]
- -> Headmistress_masturbation_comments ->

+[wait:5]
- -> Headmistress_punishment_resumes ->

->->


= break03

/perform smooth_skirt
Rise and present your ass that my students may inspect your progress thus far. #36

+ [pose:present_ass]
    -> Headmistress_AcknowledgeYes ->

+ [timeout] -> Headmistress_NoAction -> break03

/character crowd gasps
/character headmistress

- /perform one_finger
Remember to intersperse strikes with caresses. #184

/perform open_arms_behold
The inflamed flesh is delightfully sensitive #185
and should be titillated as much as possible. #186

/perform idle_tease
The tantalizing drag of fingers on welted skin #187
regularly sends shivers through the subject. #188

/perform idle
Would you enjoy that, {player_name}? #189

+ [yes]
    /perform head_toss
    ~ addObey()
    Sorry, shivers are reserved for reward spankings only. #190

+ [no]
    /perform idle_tease
    ~ addDisobey()
    Good. Then you will be pleased to know that #191
    such kind treatment is reserved for reward spankings only! #192

+ [timeout] -> Headmistress_Timeout -> break03
+ [distracted] -> Headmistress_PayAttention -> break03

- -> Headmistress_punishment_resumes ->

->->


= break04

Perhaps our little foible here needs a carrot #193
dangled in front of {isBoy: him|her}. #194
/character crowd murmur

/character headmistress satisfied
Great rewards are bestowed upon the most worthy. #197

/perform curious
What do you think, {isBoy: runt|poppet}? #198

- (treatment)

Shall I show you the kind of treatment #199
good boys and girls earn? #200

+[yes]
    ~ addDisobey()
    /character headmistress caress_breasts_large
    -- (soft)
    Do you imagine they are soft, {player_name}? #201
    
    ++[yes]
        ~ addObey()
        /character headmistress caress_breasts_large
        Mmmm. Very soft indeed. #202
    
    ++[no]
        ~ addDisobey()
        /character headmistress laugh
        --- (coarse)
        Do you imagine they are coarse and uneven, #203
        just like your hindquarters? #204

        +++[yes]
            ~ addDisobey()
            /character crowd gasps
            /character headmistress displeased
            A brazen response. #205
            Another punishment has been added to your band. #206
            ~ addPunishment()

        //player should either receive another punishment stone or an additional 5 swats

        +++[no]
            ~ addDisobey()
            /perform nod
            As I surmised. #207
            /perform confused
            You are a buffoon who does not know to think before acting. #209
            
        +++ [timeout] -> Headmistress_Timeout -> coarse
        +++ [distracted] -> Headmistress_PayAttention -> coarse

    ++ [timeout] -> Headmistress_Timeout -> soft
    ++ [distracted] -> Headmistress_PayAttention -> soft

+[no]
    ~ addObey()
    /character headmistress pleased
    My my. A surprisingly chaste response #210
    from one whose {hasPenis: shaft|mound} is throbbing so fully. #212
    
    /perform idle
    But a delightful one. #213
    You have not earned a reward, #214
    so why bestow a taste upon you. #215

+ [timeout] -> Headmistress_Timeout -> treatment
+ [distracted] -> Headmistress_PayAttention -> treatment

/character headmistress
- -> Headmistress_punishment_resumes ->

->->



